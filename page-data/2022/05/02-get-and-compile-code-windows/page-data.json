{"componentChunkName":"component---src-templates-blog-post-js","path":"/2022/05/02-get-and-compile-code-windows/","result":{"data":{"site":{"siteMetadata":{"title":"W.S. Peng 部落格"}},"markdownRemark":{"id":"fde08981-a6b9-5c94-854b-8184d7f5ede1","excerpt":"本章介紹如何下載與編譯 Chromium 程式碼 系統需求 A 64-bit Intel/AMD machine with at least 8GB of RAM. More than 16GB is highly recommended. At least 100GB of free disk space on an…","html":"<p>本章介紹如何下載與編譯 Chromium 程式碼</p>\n<h2>系統需求</h2>\n<ul>\n<li>A 64-bit Intel/AMD machine with at least 8GB of RAM. More than 16GB is highly recommended.</li>\n<li>At least 100GB of free disk space on an NTFS-formatted hard drive. FAT32 will not work, as some of the Git packfiles are larger than 4GB.</li>\n<li>An appropriate version of Visual Studio, as described below.</li>\n<li>Windows 10 or 更新版本的 Windows .</li>\n</ul>\n<h2>設定 Windows 建置環境</h2>\n<h3>Visual Studio</h3>\n<p>本文章使用 Visual Studio 2022，請先安裝以下元件</p>\n<ul>\n<li>Desktop development with C++\n<ul>\n<li>MFC/ATL support</li>\n</ul>\n</li>\n<li>10.0.20348.0 Windows 10 SDK</li>\n<li>Debugging Tools For Windows</li>\n<li>Python3</li>\n</ul>\n<h3>安裝 <a href=\"https://storage.googleapis.com/chrome-infra/depot_tools.zip\">depot_tools</a></h3>\n<p>將 dept_tools.zip 解壓縮到 c:\\src\\dept_tools ，並且加到環境變數 PATH。增加以下兩個變數 SET <code class=\"language-text\">DEPOT_TOOLS_WIN_TOOLCHAIN=0</code>，與視情況設定 Visual Studio 所在路徑 <code class=\"language-text\">vs2017_install</code> or <code class=\"language-text\">vs2019_install</code> or <code class=\"language-text\">vs2022_install</code> to your installation path of Visual Studio 2017 or 19 or 22, like set vs2019_install=C:\\Program Files (x86)\\Microsoft Visual Studio\\2019\\Professional for Visual Studio 2019, or set vs2022_install=C:\\Program Files\\Microsoft Visual Studio\\2022\\Professional for Visual Studio 2022.</p>\n<p>第一次需先執行 gclient ，gclient 會自動下載安裝 python 等相關必要的 binary。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ gclient</code></pre></div>\n<h2>取得程式碼</h2>\n<p>建立工作目錄</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ <span class=\"token function\">mkdir</span> ~/chromium <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">cd</span> ~/chromium</code></pre></div>\n<p>執行 fetch 取得程式碼。 fetch 是 depot_tool 提供的工具，若出現 command not found，請重新安裝 depot_tools。並確認 python3 有安裝正確並且是可正確執行的。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ fetch chromium</code></pre></div>\n<p>如果不需要 git history 可用 —no-history 減少下載的時間。在快的網路環境大約需要 30 分鐘下載程式碼，在慢的網路環境大約要數個小時。</p>\n<p>下載成功後，可以看到 .gclient 檔案與 src 目錄，切換到 src 目錄</p>\n<h3>建置工具</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ gn gen out\\Default</code></pre></div>\n<h3>編譯程式碼</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ autoninja -C out\\Default chrome</code></pre></div>\n<h3>執行 Chromium</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ out\\Default\\Chrome</code></pre></div>\n<h2>建置指定版本的 Chromium</h2>\n<h3>簽出指定版本</h3>\n<p>如果需要編譯指定版本的 Chromium，可用 git tag 或用 <a href=\"https://omahaproxy.appspot.com/\">線上</a> 查詢版本後，使用 git checkout -b 取得該版本的 Chromium 進行編譯。</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ git checkout -b develop 102.0.5005.125</code></pre></div>\n<h3>建置工具</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ gn gen out\\Default</code></pre></div>\n<h3>編譯程式碼</h3>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">$ autoninja -C out\\Default chrome</code></pre></div>","frontmatter":{"title":"Chromium 瀏覽器內核原理（02）-取得與編譯程式碼","date":"May 13, 2022","description":null}},"previous":{"fields":{"slug":"/2022/05/01-introduction/"},"frontmatter":{"title":"Chromium 瀏覽器內核原理（01）-組成簡介"}},"next":{"fields":{"slug":"/2022/07/cloud-flare-gcp-load-balancer/"},"frontmatter":{"title":"CloudFlare CDN 與 GCP Load Balancer 設定教學"}}},"pageContext":{"id":"fde08981-a6b9-5c94-854b-8184d7f5ede1","previousPostId":"29d9fbdc-30fa-50b8-992f-342f62afe2e6","nextPostId":"6e25d048-51a0-5171-ab77-bf6aa7ec2b25"}},"staticQueryHashes":["2841359383","3257411868"]}