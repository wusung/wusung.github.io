{"componentChunkName":"component---src-templates-blog-post-js","path":"/2022/08/03-build-debug-environment/","result":{"data":{"site":{"siteMetadata":{"title":"W.S. Peng 部落格"}},"markdownRemark":{"id":"8b001b5a-09b6-588f-915f-dc6180decb37","excerpt":"本章節介紹如何使用 JetBrains CLion Debug Chromium。 設定 CLoin 啟動 CLion，請先設定 JVM 參數，Help > Edit Custom VM Options… 使用 CLion 開啟 Chromium 匯入 Chromium\n在 File > Import…","html":"<p>本章節介紹如何使用 <a href=\"https://www.jetbrains.com/clion/\">JetBrains CLion</a> Debug Chromium。</p>\n<h2>設定 CLoin</h2>\n<ol>\n<li>啟動 CLion，請先設定 JVM 參數，Help > Edit Custom VM Options…</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">-Xss2m\n-Xms1g\n-Xmx5g</code></pre></div>\n<h2>使用 CLion 開啟 Chromium</h2>\n<ol>\n<li>\n<p>匯入 Chromium\n在 File > Import  選擇 chromium 目錄後，按下確認</p>\n</li>\n<li>\n<p>在根目錄下新增 CMakeLists.txt，內容如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">cmake_minimum_required(VERSION 3.10)\nproject(chromium)\n\nset(CMAKE_CXX_STANDARD 14)\n\ninclude_directories(${CMAKE_CURRENT_SOURCE_DIR}/src)\ninclude_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/out/Default/gen)\ninclude_directories(${CMAKE_CURRENT_SOURCE_DIR}/src/third_party/googletest/src/googletest/include)\n\nadd_executable(chromium src/components/omnibox/browser/document_provider.cc)</code></pre></div>\n</li>\n</ol>\n<h2>建置、執行或Debug Chromium</h2>\n<ol>\n<li>\n<p>新增 <code class=\"language-text\">custom build targets</code> 設定</p>\n<ol>\n<li>按下 <code class=\"language-text\">ctrl-shift-a</code> 後，輸入 custom build targets</li>\n<li>按下 <code class=\"language-text\">+</code> 新增 target</li>\n<li>按下在 <code class=\"language-text\">Build</code> 欄位旁邊的按鈕 <code class=\"language-text\">...</code></li>\n<li>按下在新增列上的 <code class=\"language-text\">+</code> 按鈕</li>\n<li>設定欄位：\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Program: &lt;absolute path to depot_tools/autoninja>\nArguments: -C src/out/Default -j 1000 chrome</code></pre></div>\n</li>\n</ol>\n</li>\n<li>\n<p>新增 <code class=\"language-text\">Run</code> 設定</p>\n<ol>\n<li>按下 <code class=\"language-text\">ctrl-shift-a</code> 後，輸入 edit configurations</li>\n<li>Click <code class=\"language-text\">+</code> in the top left and select <code class=\"language-text\">Custom Build Application</code></li>\n<li>Set the <code class=\"language-text\">Target</code> field to one of the targets configured in step 1</li>\n<li>Click <code class=\"language-text\">Select other</code> option for the <code class=\"language-text\">Executable</code> field and select the</li>\n</ol>\n<p>chrome build e.g. <code class=\"language-text\">out/Default/chrome</code></p>\n<ol>\n<li>在 Program Arguments 輸入 —single-process <a href=\"https://www.google.com\">https://www.google.com</a> (註一)</li>\n</ol>\n</li>\n<li>\n<p>Debug Chromium，選擇 <code class=\"language-text\">Run</code> > <code class=\"language-text\">Debug</code> 或使用快速鍵 <code class=\"language-text\">shift+f9</code></p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/c5fcfe01ea1774e18f4a7cdd610291ec/29114/clion_gui_debugging.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 53.79746835443038%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAIAAADwazoUAAAACXBIWXMAAA7EAAAOxAGVKw4bAAABAklEQVQoz6XQ2U7DMBBAUf//z7GoBRSSVM1SO7bjJY7jxNsgFakqiKIiju7DPM4MOh7ruq7Kqjzhjg4954QxLCSTil8nJMWkJbTnI+acUI4pPSFjOjPh2ZAcFeQJwH5t/mk2ABpAoX01PBbDwxt5Kvj+oHa1vKd9rXbliKoWP79WRdW1WJyY4sqNeh21+4yr5TJ/izCNQnB+c351kCNAgr9AlLKRj0LIebbrui2Ls9YuZ8655TZrLXovXtruQFlPaScEkXJgjHHGlZJaTZMx9gatNZqmYjZlCE2MTUpNzv26+W3zMYbgY86/rp2Sz9kDhKvyvTfDP6DLA5xbtrOUUr7PBzzDdv5JGtICAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"debugging screenshot\"\n        title=\"debugging screenshot\"\n        src=\"/static/c5fcfe01ea1774e18f4a7cdd610291ec/f058b/clion_gui_debugging.png\"\n        srcset=\"/static/c5fcfe01ea1774e18f4a7cdd610291ec/c26ae/clion_gui_debugging.png 158w,\n/static/c5fcfe01ea1774e18f4a7cdd610291ec/6bdcf/clion_gui_debugging.png 315w,\n/static/c5fcfe01ea1774e18f4a7cdd610291ec/f058b/clion_gui_debugging.png 630w,\n/static/c5fcfe01ea1774e18f4a7cdd610291ec/40601/clion_gui_debugging.png 945w,\n/static/c5fcfe01ea1774e18f4a7cdd610291ec/78612/clion_gui_debugging.png 1260w,\n/static/c5fcfe01ea1774e18f4a7cdd610291ec/29114/clion_gui_debugging.png 1920w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n</li>\n<li>\n<p>執行 Chromium，選擇 <code class=\"language-text\">Run</code> > <code class=\"language-text\">Run</code> 或使用快速鍵 <code class=\"language-text\">shift+f10</code></p>\n</li>\n</ol>\n<h2>其他</h2>\n<ul>\n<li>\n<p>註一：Chromium debug 參數說明</p>\n<ol>\n<li>—single-process: 用單一個 process 啟動 Chromium，此模式 renderer worker thread 仍然 folk 新的 process</li>\n<li>—renderer-startup-dialog: 啟動前顯示 process id，此時可以用 debug 工具 attach 此 process。Startup dialog 有其他參數可以使用，分別是 —gpu-startup-dialog, —ppapi-startup-dialog, —utility-startup-dialog, —plugin-startup-dialog (for NPAPI)。—utility-startup-dialog 可以指定使用特定 service，—utility-startup-dialog=data_decoder.mojom.DataDecoderService</li>\n<li>—no-sandbox: Chromium 預設開啟 sandbox，如果啟用 —renderer-startup-dialog，需配合此參數使用</li>\n<li>—wait-for-debugger-children[=filter]: Values include <code class=\"language-text\">renderer</code>, <code class=\"language-text\">plugin</code> (for NPAPI), <code class=\"language-text\">ppapi</code>, <code class=\"language-text\">gpu-process</code>, and <code class=\"language-text\">utility</code>.</li>\n<li>—renderer-process-limit=1: 啟用 —wait-for-debugger-children[=filter] 時，可將 process-limit 設定為 1，方便 debug。</li>\n</ol>\n</li>\n<li>\n<p>註二：更多的 debug 說明可參考官網文件 <a href=\"https://www.chromium.org/developers/how-tos/debugging-on-windows/\">Debugging Chromium on Windows</a></p>\n</li>\n</ul>","frontmatter":{"title":"Chromium 瀏覽器內核原理（03）-使用 CLion 建立 Chromium Debug 環境","date":"August 09, 2022","description":null}},"previous":{"fields":{"slug":"/2022/07/java-roadmap-2022/"},"frontmatter":{"title":"2022 Java Developers Roadmap"}},"next":{"fields":{"slug":"/2022/08/soloar-tweaks-patch/"},"frontmatter":{"title":"Unofficial Solar-Tweaks patch for lunar client"}}},"pageContext":{"id":"8b001b5a-09b6-588f-915f-dc6180decb37","previousPostId":"89a49ef6-073f-59f5-b4dd-ba59e14b907e","nextPostId":"668fdf28-73cd-561c-8a14-7235e0f756da"}},"staticQueryHashes":["2841359383","3257411868"]}